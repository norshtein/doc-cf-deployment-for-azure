<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
    WEB_SOCKET_SWF_LOCATION = "/__rack/WebSocketMain.swf";
    
  </script>
  <script type="text/javascript" src="azure_files/swfobject.js"></script>
  <script type="text/javascript" src="azure_files/web_socket.js"></script>

<script type="text/javascript">
  RACK_LIVERELOAD_PORT = 35729;
</script>
<script type="text/javascript" src="azure_files/livereload.js"></script>


  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  
  <link href="azure_files/css.css" rel="stylesheet" type="text/css">
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      Deploying BOSH on Azure |
    Cloud Foundry Docs
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="azure_files/all.css" rel="stylesheet" media="screen, print">
  <link href="azure_files/print.css" rel="stylesheet" media="print">
  <link href="http://localhost:4567/images/favicon.ico" rel="shortcut icon">

  <script src="azure_files/all.js"></script>
  <script type="text/javascript">
if (window.location.host === 'docs.cloudfoundry.org') {
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-22181585-2']);
  _gaq.push(['_setDomainName', 'cloudfoundry.org']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script');
    ga.type = 'text/javascript';
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ga, s);
  })();
}
</script>


</head>

<body class="deploying deploying_cf-deployment deploying_cf-deployment_azure has-subnav">

<div class="viewport">
  <div class="wrap">
    <script type="text/javascript">
      document.domain = "cloudfoundry.org";
    </script>

     
  <header class="header header-layout">
    <h1 class="logo">
      <a href="http://localhost:4567/">Cloud Foundry Documentation</a>
    </h1>
    
    <div class="header-links js-bar-links">
      <div class="btn-menu" data-behavior="MenuMobile"></div>
      
      <div class="header-item">
        <a href="https://www.cloudfoundry.org/community/" target="_blank">Get Involved</a>
      </div>
      <div class="searchbox header-item">
  <form method="get" action="/search">
    <input name="q" placeholder="Search" class="search-box">
  </form>
</div>

    </div>
  </header>


    <div class="container">

      <!--googleoff: index-->
      <div id="sub-nav" class="js-sidenav collapsible nav-container" role="navigation" data-behavior="Collapsible">
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    <ul>
     <li><strong>General Information</strong></li>
     <!--<li><span>Cloud Foundry Documentation Overview</span></li>-->
    <li>
    <a href="http://localhost:4567/concepts/contribute.html">Contributing Documentation</a>
    </li>
     <li class="has_submenu">
        <span>
          Cloud Foundry Concepts
        </span>
        <ul>
          <!--
            <li>
            <a href="/concepts/index.html">Cloud Foundry Concepts (landing)</a>
            </li>
          -->
          
          <li>
            <a href="http://localhost:4567/concepts/overview.html">Cloud Foundry Overview</a>
          </li>
          <li>
            <a href="http://localhost:4567/concepts/architecture/">Cloud Foundry Components</a>
          </li>
          <li>
            <a href="http://localhost:4567/concepts/diego/diego-architecture.html">Diego Components and Architecture</a>
          </li>
          <li>
            <a href="http://localhost:4567/concepts/diego/diego-auction.html">How the Diego Auction Allocates Jobs</a>
          </li>
          <li>
            <a href="http://localhost:4567/concepts/how-applications-are-staged.html">How Applications Are Staged</a>
          </li>
          <li>
            <a href="http://localhost:4567/concepts/diego/ssh-conceptual.html">Understanding Application SSH</a>
          </li>
          <li>
            <a href="http://localhost:4567/concepts/roles.html">Orgs, Spaces, Roles, and Permissions</a>
          </li>
          <li>
            <a href="http://localhost:4567/concepts/security.html">Cloud Foundry Security</a>
          </li>
          <li>
            <a href="http://localhost:4567/concepts/container-security.html">Understanding Container Security</a>
          </li>
          <li>
            <a href="http://localhost:4567/concepts/understand-cf-networking.html">Understanding Container-to-Container Networking</a>
          </li>
            <li>
            <a href="http://localhost:4567/concepts/architecture/uaa.html">User Account and Authentication (UAA) Server</a>
          </li>
            <li>
            <a href="http://localhost:4567/concepts/http-routing.html">HTTP Routing</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/stacks.html">Stacks</a>
          </li>
        </ul>
      </li>
      <li class="has_submenu">
        <span>Cloud Foundry Command Line Interface (cf CLI)</span>
        <ul>
          <li>
            <a href="http://localhost:4567/cf-cli/install-go-cli.html">Installing the cf CLI</a>
          </li>
          <li>
            <a href="http://localhost:4567/cf-cli/getting-started.html">Getting Started with the cf CLI</a>
          </li>
          <li>
            <a href="http://localhost:4567/cf-cli/http-proxy.html">Using the cf CLI with a Proxy Server</a>
          </li>
          <li>
            <a href="http://localhost:4567/cf-cli/self-signed.html">Using the cf CLI with a Self-Signed Certificate</a>
          </li>
          <li>
            <a href="http://localhost:4567/cf-cli/use-cli-plugins.html">Using cf CLI Plugins</a>
          </li>
          <li>
            <a href="http://localhost:4567/cf-cli/develop-cli-plugins.html">Developing cf CLI Plugins</a>
          </li>
          <li>
            <a href="http://localhost:4567/cf-cli/cf-help.html">cf CLI Reference Guide</a>
          </li>
        </ul>
      </li>
      <li><span><hr></span></li>
      <li><strong>Information for Operators</strong></li>
      <li class="has_submenu">
        <a href="http://localhost:4567/deploying/index.html">Deploying Cloud Foundry</a>
      <ul>
        <li><a href="http://localhost:4567/deploying/common/dns_prereqs.html">Setting Up DNS for Your Environment</a></li>
        <li class="has_submenu">
          <a href="http://localhost:4567/deploying/cf-deployment/index.html">Deploying Cloud Foundry with cf-deployment</a>
        <ul>
          <li><a href="http://localhost:4567/deploying/common/aws.html">Deploying BOSH on AWS</a></li>
          <li><a href="http://localhost:4567/deploying/cf-deployment/gcp.html">Deploying BOSH on GCP</a></li>
          <li><a href="http://localhost:4567/deploying/cf-deployment/deploy-cf.html">Deploying Cloud Foundry</a></li>
        </ul>
        </li>
        <li><a href="http://localhost:4567/deploying/migrating.html">Migrating from cf-release to cf-deployment</a></li>
        <li class="has_submenu">
            <a href="http://localhost:4567/bbr/cf-backup.html">Configuring your Cloud Foundry for BOSH Backup and Restore (Experimental)</a>
            <ul>
              <li>
                <a href="http://localhost:4567/bbr/external-blobstores.html">Backup and Restore with External Blobstores</a>
              </li>
            </ul>
        </li>
        <li class="has_submenu">
            <span>Additional Configuration</span>
            <ul>
            <li>
              <a href="http://localhost:4567/concepts/high-availability.html">High Availability in Cloud Foundry</a>
            </li>
            <li>
              <a href="http://localhost:4567/deploying/common/log_drain_blacklists.html">Log Drain Blacklist Configuration</a>
            </li>
            <li>
              <a href="http://localhost:4567/deploying/common/consul-security.html">Security Configuration for Consul</a>
            </li>
            <li>
              <a href="http://localhost:4567/deploying/common/cc-blobstore-config.html">Cloud Controller Blobstore Configuration</a>
            </li>
            </ul>
        </li>
      </ul>
      </li>
      <li class="has_submenu">
        <a href="http://localhost:4567/adminguide/index.html">Administering Cloud Foundry</a>
        <ul>
          <li>
            <a href="http://localhost:4567/adminguide/buildpacks.html">Managing Custom Buildpacks</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/docker.html">Using Docker in Cloud Foundry</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/manage-domains-routes.html">Managing Domains and Routes</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/cli-user-management.html">Creating and Managing Users with the cf CLI</a>
          </li>
          <li>
            <a href="http://localhost:4567/uaa/uaa-user-management.html">Creating and Managing Users with the UAA CLI (UAAC)</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/quota-plans.html">Creating and Modifying Quota Plans</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/notifications.html">Getting Started with the Notifications Service</a>
          </li>
          <li>
            <a href="http://localhost:4567/concepts/asg.html">Application Security Groups</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/cf-networking.html">Administering Container-to-Container Networking</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/isolation-segments.html">Managing Isolation Segments</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/routing-is.html">Routing for Isolation Segments</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/listing-feature-flags.html">Feature Flags</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/diego-cell-upgrade.html">Managing Diego Cell Limits During Upgrade</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/max-container-starts.html">Setting a Maximum Number of Started Containers</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/bbs-encryption-keys.html">Bulletin Board System (BBS) Data Store Encryption</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/enabling_ipv6.html">Enabling IPv6 for Hosted Applications</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/securing-traffic.html">Securing Traffic into Cloud Foundry</a>
          </li>
          <li>
            <a href="http://localhost:4567/running/trusted-system-certificates.html">Configuring Trusted System Certificates for Applications</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/enabling-tcp-routing.html">Enabling TCP Routing</a>
          </li>
          <li>
          </li><li>
            <a href="http://localhost:4567/adminguide/troubleshooting_tcp_routing.html">Troubleshooting TCP Routing</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/zipkin_tracing.html">Enabling Zipkin Tracing</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/supporting-websockets.html">Supporting WebSockets</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/configure-lb-healthcheck.html">Configuring Load Balancer Healthchecks for Cloud Foundry Routers</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/troubleshooting_slow_requests.html">Troubleshooting Slow Requests in Cloud Foundry</a>
          </li>
          <li>
            <a href="http://localhost:4567/running/setting-rate-limit-cloud-api.html">Setting the Rate Limit for the Cloud Controller API</a>
          </li>
          <li>
            <a href="http://localhost:4567/running/deploy-vol-services.html">Adding Volume Services to your Deployment</a>
          </li>
          <li>
            <a href="http://localhost:4567/adminguide/routing-keepalive.html">Router Back-End Keepalive Connections</a>
          </li>
        </ul>
      </li>
      <li class="has_submenu">
        <a href="http://localhost:4567/running/">Running and Troubleshooting Cloud Foundry</a>
        <ul>
          <li>
            <a href="http://localhost:4567/running/managing-cf/logging.html">Cloud Foundry Logging</a>
          </li>
          <li>
            <a href="http://localhost:4567/running/managing-cf/logging-config.html">Configuring System Logging</a>
          </li>
          <li>
            <a href="http://localhost:4567/running/managing-cf/usage-events.html">Usage Events and Billing</a>
          </li>
          <li>
            <a href="http://localhost:4567/running/config-ssh.html">Configuring SSH Access for Cloud Foundry</a>
          </li>
          <li>
            <a href="http://localhost:4567/running/config-cell-cleanup.html">Configuring Cell Disk Cleanup Scheduling</a>
          </li>
          <li>
            <a href="http://localhost:4567/running/hm-notifications.html">Configuring Health Monitor Notifications</a>
          </li>
          <li>
            <a href="http://localhost:4567/running/monitoring-test.html">Monitoring and Testing Diego Components</a>
          </li>
          <li>
            <a href="http://localhost:4567/running/troubleshooting.html">Troubleshooting Cloud Foundry</a>
          </li>
          <li>
            <a href="http://localhost:4567/running/troubleshooting/troubleshooting-diego-windows.html">Troubleshooting Diego for Windows</a>
          </li>
          <li>
            <a href="http://localhost:4567/running/uaa-performance.html">UAA Performance</a>
          </li>
        </ul>
      </li>
      <li class="has_submenu">
        <span>
          Logging and Metrics in Cloud Foundry
        </span>
        <ul>
          <li>
            <a href="http://localhost:4567/loggregator/architecture.html">Overview of the Loggregator System</a>
          </li>
          <li>
            <a href="http://localhost:4567/loggregator/cli-plugin.html">Installing the Loggregator Plugin for CF CLI</a>
          </li>
          <li>
            <a href="http://localhost:4567/loggregator/cc-uaa-logging.html">Security Event Logging for Cloud Controller and UAA</a>
          </li>
          <li>
            <a href="http://localhost:4567/running/all_metrics.html">Cloud Foundry Component Metrics</a>
          </li>
          <li>
            <a href="http://localhost:4567/loggregator/log-ops-guide.html">Loggregator Guide for Cloud Foundry Operators</a>
          </li>
          <li>
            <a href="http://localhost:4567/loggregator/data-sources.html">Cloud Foundry Data Sources</a>
          </li>
          <li>
            <a href="http://localhost:4567/loggregator/nozzle-tutorial.html">Deploying a Nozzle to the Loggregator Firehose</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="http://bosh.io/docs/">BOSH Documentation</a>
      </li>
      <li class="has_submenu">
        <a href="http://localhost:4567/bbr/index.html">BOSH Backup and Restore</a>
        <ul>
          <li>
            <a href="http://localhost:4567/bbr/installing.html">Installing BBR</a>
          </li>
          <li>
            <a href="http://localhost:4567/bbr/bbr-rn.html">Release Notes for BBR</a>
          </li>
          <li>
            <a href="http://localhost:4567/bbr/backup.html">Backing Up with BBR</a>
          </li>
          <li>
            <a href="http://localhost:4567/bbr/restore.html">Restoring with BBR</a>
          </li>
          <li>
            <a href="http://localhost:4567/bbr/logging.html">BBR Exit Codes and Logging</a>
          </li>
          <li>
            <a href="http://localhost:4567/bbr/bbr-devguide.html">BBR Developer's Guide</a>
          </li>
        </ul>
      </li>
      <li><span><hr></span></li>
      <li><strong>Information for Developers</strong></li>
      <li class="has_submenu">
        <span>
          Developing and Managing Applications
        </span>
        <ul>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/prepare-to-deploy.html">Considerations for Designing and Running an Application in the Cloud</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/deploy-app.html">Deploy an Application</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/large-app-deploy.html">Deploy a Large Application</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/push-docker.html">Deploy an App with Docker</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/start-restart-restage.html">Starting, Restarting, and Restaging Applications</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/manifest.html">Deploying with Application Manifests</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/app-lifecycle.html">Application Container Lifecycle</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/healthchecks.html">Using Application Health Checks</a></li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/cf-scale.html">Scaling an Application Using cf scale</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/using-tasks.html">Running Tasks</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/routes-domains.html">Routes and Domains</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/stacks.html">Changing Stacks</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/environment-variable.html">Cloud Foundry Environment Variables</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/blue-green.html">Using Blue-Green Deployment to Reduce Downtime and Risk</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/streaming-logs.html">Application Logging in Cloud Foundry</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/troubleshoot-app-health.html">Troubleshooting Application Deployment and Health</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/app-ssh-overview.html">Application SSH Overview</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/ssh-apps.html">Accessing Apps with Diego SSH</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/ssh-services.html">Accessing Services with Diego SSH</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/deploy-apps/trusted-system-certificates.html">Trusted System Certificates</a>
         </li>
          <li>
            <a href="http://localhost:4567/running/cf-api-endpoint.html">Identifying your Cloud Foundry API Endpoint and Version</a>
          </li>
          <li>
            <a href="http://localhost:4567/devguide/v3-commands.html">Using Experimental cf CLI Commands</a>
          </li>
          <li class="has_submenu">
            <span>Integrating Service Instances with Applications</span>
            <ul>
              <li>
                <a href="http://localhost:4567/devguide/services/">Services Overview</a>
              </li>
              <li>
                <a href="http://localhost:4567/devguide/services/application-binding.html">Delivering Service Credentials to an Application</a>
              </li>
              <li>
                <a href="http://localhost:4567/devguide/services/managing-services.html">Managing Service Instances with the CLI</a>
              </li>
              <li>
                <a href="http://localhost:4567/devguide/services/service-keys.html">Managing Service Keys</a>
              </li>
              <li>
                <a href="http://localhost:4567/devguide/services/sharing-instances.html">Sharing Service Instances</a>
              </li>
              <li>
                <a href="http://localhost:4567/devguide/services/user-provided.html">User-Provided Service Instances</a>
              </li>
              <li>
                <a href="http://localhost:4567/devguide/services/route-binding.html">Manage Application Requests with Route Services</a>
              </li>
              <li>
                <a href="http://localhost:4567/devguide/services/using-vol-services.html">Using an External File System (Volume Services)</a>
              </li>
              <li>
                <a href="http://localhost:4567/devguide/services/play-service-bindings.html">Configuring Play Framework Service Connections</a>
              </li>
              <li>
                <a href="http://localhost:4567/devguide/services/migrate-db.html">Migrating a Database in Cloud Foundry</a>
              </li>
              <li>
                <a href="http://localhost:4567/devguide/services/log-management.html">Streaming Application Logs to Log Management Services</a>
              </li>
              <li>
                <a href="http://localhost:4567/devguide/services/log-management-thirdparty-svc.html">Service-Specific Instructions for Streaming Application Logs</a>
              </li>
              <li>
                <a href="http://localhost:4567/devguide/services/integrate-splunk.html">Integrating Cloud Foundry with Splunk</a>
              </li>
            </ul>
          </li>
        </ul>
      </li>

      <li class="has_submenu">
          <a href="http://localhost:4567/buildpacks/">Buildpacks</a>
        <ul>
          <li class="has_submenu">
            <a href="http://localhost:4567/buildpacks/using-buildpacks.html">About Buildpacks</a>
            <ul>
              <li>
                <a href="http://localhost:4567/buildpacks/understand-buildpacks.html">Understanding Buildpacks</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/use-multiple-buildpacks.html">Pushing an Application with Multiple Buildpacks</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/proxy-usage.html">Using a Proxy</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/supported-binary-dependencies.html">Supported Binary Dependencies</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/prod-server.html">Production Server Configuration</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="http://localhost:4567/buildpacks/binary/index.html">Binary</a>
          </li>
          <li>
            <a href="http://localhost:4567/buildpacks/go/index.html">Go</a>
          </li>
          <li class="has_submenu">
            <a href="http://localhost:4567/buildpacks/java/index.html">Java</a>
            <ul>
              <li>
                <a href="http://localhost:4567/buildpacks/java/java-tips.html">Tips for Java Developers</a>
              </li>
              <li class="has_submenu">
                <a href="http://localhost:4567/buildpacks/java/getting-started-deploying-apps/index.html">Getting Started Deploying Apps</a>
                <ul>
                  <li>
                    <a href="http://localhost:4567/buildpacks/java/getting-started-deploying-apps/gsg-grails.html">Grails</a>
                  </li>
                  <li>
                    <a href="http://localhost:4567/buildpacks/java/getting-started-deploying-apps/gsg-ratpack.html">Ratpack</a>
                  </li>
                  <li>
                   <a href="http://localhost:4567/buildpacks/java/getting-started-deploying-apps/gsg-spring.html">Spring</a>
                  </li>
                </ul>
              </li>
              <li class="has_submenu">
                <a href="http://localhost:4567/buildpacks/java/configuring-service-connections/index.html">Configuring Service Connections</a>
                <ul>
                  <li>
                    <a href="http://localhost:4567/buildpacks/java/configuring-service-connections/grails-service-bindings.html">Grails</a>
                  </li>
                  <li>
                    <a href="http://localhost:4567/buildpacks/java/configuring-service-connections/play-service-bindings.html">Play</a>
                  </li>
                  <li>
                    <a href="http://localhost:4567/buildpacks/java/configuring-service-connections/spring-service-bindings.html">Spring</a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/java/sts.html">Cloud Foundry Eclipse Plugin</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/java/java-client.html">Cloud Foundry Java Client Library</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="http://localhost:4567/buildpacks/dotnet-core/index.html">.NET Core</a>
          </li>
          <li class="has_submenu">
            <a href="http://localhost:4567/buildpacks/node/index.html">Node.js</a>
            <ul>
              <li>
                <a href="http://localhost:4567/buildpacks/node/node-tips.html">Tips for Node.js Applications</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/node/node-environment.html">Environment Variables Defined by the Node Buildpack</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/node/node-service-bindings.html">Configure Service Connections for Node.js</a>
              </li>
            </ul>
          </li>
          <li class="has_submenu">
            <a href="http://localhost:4567/buildpacks/php/index.html">PHP</a>
            <ul>
              <li>
                <a href="http://localhost:4567/buildpacks/php/gsg-php-tips.html">Tips for PHP Developers</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/php/gsg-php-usage.html">Getting Started Deploying PHP Apps</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/php/gsg-php-config.html">PHP Buildpack Configuration</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/php/gsg-php-composer.html">Composer</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/php/gsg-php-sessions.html">Sessions</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/php/gsg-php-newrelic.html">New Relic</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="http://localhost:4567/buildpacks/python/index.html">Python</a>
          </li>
          <li class="has_submenu">
            <a href="http://localhost:4567/buildpacks/ruby/index.html">Ruby</a>
            <ul>
              <li>
                <a href="http://localhost:4567/buildpacks/ruby/ruby-tips.html">Tips for Ruby Developers</a>
              </li>
              <li class="has_submenu">
                <a href="http://localhost:4567/buildpacks/ruby/deploying-apps-index.html">Getting Started Deploying Apps</a>
                <ul>
                  <li>
                    <a href="http://localhost:4567/buildpacks/ruby/gsg-ruby.html">Ruby</a>
                  </li>
                  <li>
                    <a href="http://localhost:4567/buildpacks/ruby/gsg-ror.html">Ruby on Rails</a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/ruby/rake-config.html">Configure Rake Tasks for Deployed Apps</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/ruby/ruby-environment.html">Environment Variables Defined by the Ruby Buildpack</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/ruby/ruby-service-bindings.html">Configure Service Connections for Ruby</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/ruby/windows.html">Support for Windows Gemfiles</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="http://localhost:4567/buildpacks/staticfile/index.html">Staticfile</a>
          </li>
          <li class="has_submenu">
            <a href="http://localhost:4567/buildpacks/developing-buildpacks.html">Customizing and Developing Buildpacks</a>
            <ul>
              <li>
                  <a href="http://localhost:4567/buildpacks/custom.html">Creating Custom Buildpacks</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/depend-pkg-offline.html">Packaging Dependencies for Offline Buildpacks</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/merging_upstream.html">Merging from Upstream Buildpacks</a>
              </li>
              <li>
                <a href="http://localhost:4567/buildpacks/upgrading_dependency_versions.html">Upgrading Dependency Versions</a>
              </li>
              <li class="has_submenu">
                <a href="http://localhost:4567/buildpacks/buildpack-ci-index.html">Using CI for Buildpacks</a>
                <ul>
                  <li>
                    <a href="http://localhost:4567/buildpacks/releasing_a_new_buildpack_version.html">Releasing a New Buildpack Version</a>
                  </li>
                  <li>
                    <a href="http://localhost:4567/buildpacks/updating-buildpack-related-gems.html">Updating Buildpack-Related Gems</a>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>

      <li><span><hr></span></li>
      <li><strong>Information for Managed Service Authors</strong></li>
        <ul>
          <li>
            <a href="http://localhost:4567/services/">Custom Services</a>
          </li>
          <li>
            <a href="http://localhost:4567/services/overview.html">Overview</a>
          </li>
          <li class="has_submenu">
           <span>
           Service Broker API
           </span>
           <ul>
            <li>
              <a href="https://github.com/openservicebrokerapi/servicebroker/blob/v2.13/spec.md">Open Service Broker API</a>
            </li>
            <li>
              <a href="https://github.com/openservicebrokerapi/servicebroker/blob/v2.13/profile.md">Platform Profiles</a>
            </li>
            <li>
              <a href="https://github.com/openservicebrokerapi/servicebroker/blob/v2.13/profile.md#service-metadata">Catalog Metadata</a>
            </li>
            <li>
              <a href="https://github.com/openservicebrokerapi/servicebroker/blob/v2.13/spec.md#volume-mounts-object">Volume Services</a>
            </li>
            <li>
              <a href="https://github.com/openservicebrokerapi/servicebroker/blob/v2.13/release-notes.md">Release Notes</a>
            </li>
          </ul>
          </li>
          <li>
            <a href="http://localhost:4567/services/managing-service-brokers.html">Managing Service Brokers</a>
          </li>
          <li>
            <a href="http://localhost:4567/services/access-control.html">Access Control</a>
          </li>
          <li>
            <a href="http://localhost:4567/services/binding-credentials.html">Binding Credentials</a>
          </li>
          <li class="has_submenu">
            <a href="http://localhost:4567/credhub/index.html">CredHub</a>
            <ul>
              <li>
                <a href="http://localhost:4567/credhub/setup-credhub-bosh.html">Setting Up and Deploying CredHub with BOSH</a>
              </li>
              <li>
                <a href="http://localhost:4567/credhub/hsm-config.html">Configuring a Hardware Security Module</a>
              </li>
              <li>
                <a href="http://localhost:4567/credhub/credential-types.html">CredHub Credential Types</a>
              </li>
              <li>
                <a href="http://localhost:4567/credhub/backup-restore.html">Backing Up and Restoring CredHub Instances</a>
              </li>
              <li>
                <a href="http://localhost:4567/credhub/troubleshooting-credhub.html">Troubleshooting CredHub</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="http://localhost:4567/services/dashboard-sso.html">Dashboard Single Sign-On</a>
          </li>
          <li>
            <a href="http://localhost:4567/services/enable-sharing.html">Enabling Service Instance Sharing</a>
          </li>
          <li>
            <a href="http://localhost:4567/services/examples.html">Example Service Brokers</a>
          </li>
          <li>
            <a href="http://localhost:4567/services/app-log-streaming.html">Application Log Streaming</a>
          </li>
          <li>
            <a href="http://localhost:4567/services/route-services.html">Route Services</a>
          </li>
          <li>
            <a href="http://localhost:4567/services/supporting-multiple-cf-instances.html">Supporting Multiple Cloud Foundry Instances</a>
          </li>
        </ul>

      <li><span><hr></span></li>
      <li><strong>API Reference</strong></li>
      <li>
        <a href="https://docs.cloudfoundry.org/api/uaa/index.html">UAA API</a>
      </li>
      <li class="has_submenu"><span>CAPI API</span>
        <ul>
          <li>
            <a href="http://localhost:4567/devguide/capi/client-libraries.html">Client Libraries</a>
          </li>
          <li>
            <a href="http://localhost:4567/running/rate-limit-cloud-controller-api.html">Rate Limit Information Returned by the Cloud Controller API</a>
          </li>
          <li>
            <a href="http://apidocs.cloudfoundry.org/">CAPI V2</a>
          </li>
          <li>
            <a href="http://v3-apidocs.cloudfoundry.org/index.html">CAPI V3</a>
          </li>
        </ul>
      </li>
    </ul>
  </div>
</div>

      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        
          <h1 class="title-container">
    Deploying BOSH on Azure
  </h1>

          <div id="js-quick-links">
            <div class="quick-links"><ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#downloads">Step 1: Download Dependencies</a></li>
<li><a href="#create-service-principal">Step 2: Create a Service Principal</a></li>
<li><a href="#create-infra-bosh">Step 3: Create Infrastructure, Bastion, BOSH Director, and Application Gateway</a></li>
<li><a href="#update-dns">Step 4: Update DNS Records</a></li>
<li><a href="#connect-bosh-director">Step 5: Connect to the BOSH Director</a></li>
<li><a href="#destroy-environment">Destroy the BOSH Resources</a></li>
</ul></div>
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        <p><strong>Page last updated: <span data-behavior="DisplayModifiedDate" data-modified-date="1522129100000"></span></strong></p>

<p>This topic describes how to use the <a href="https://github.com/cloudfoundry/bosh-bootloader">bosh-bootloader</a>
command-line tool to set up an environment for Cloud Foundry on Azure and deploy a <a href="https://bosh.io/docs/bosh-components.html#director">BOSH Director</a>.</p>

<h2 id="overview"><a id="overview"></a>Overview</h2>

<p>After completing this topic, you will have the following:</p>

<ol>
<li><p>A BOSH Director instance</p></li>
<li><p>A bastion instance</p></li>
<li><p>A set of randomly generated BOSH Director credentials</p></li>
<li><p>A generated key pair that allows you to SSH into the BOSH Director and any instances that BOSH deploys</p></li>
<li><p>A copy of the manifest used to deploy the BOSH Director
</p><p class="note"><strong>Note</strong>: A <a href="https://bosh.io/docs/deployment-manifest.html">manifest</a> is a YAML file that defines the components and properties of a BOSH deployment.</p><p></p></li>
<li><p>A basic cloud config 
</p><p class="note"><strong>Note</strong>: A <a href="https://bosh.io/docs/cloud-config.html">cloud config</a> is a YAML file that defines IaaS-specific configuration for BOSH.</p><p></p></li>
<li><p>An application gateway
</p><p class="note"><strong>Note</strong>: bosh-bootloader creates the 
application gateway, but you must still configure DNS to point your 
domains to the application gateway. See the <a href="http://localhost:4567/deploying/common/dns_prereqs.html">Setting Up DNS for Your Environment</a> topic for more information.</p><p></p></li>
</ol>

<h2 id="-step-1:-download-dependencies"><a id="downloads"></a> Step 1: Download Dependencies</h2>

<p>Perform the following steps to download the required dependencies for bosh-bootloader:</p>

<ol>
<li><p>Download <a href="https://www.terraform.io/downloads.html">Terraform</a> v0.9.1 or later. Unzip the file and move it to somewhere in your PATH:
</p><pre class="terminal">$ tar xvf ~/Downloads/terraform*
$ sudo mv ~/Downloads/terraform /usr/local/bin/terraform
</pre><p></p></li>
<li><p>Download the <a href="https://bosh.io/docs/cli-v2.html#install">BOSH CLI v2</a>. Make the binary executable and move it to somewhere in your PATH:
</p><pre class="terminal">$ chmod +x ~/Downloads/bosh-cli-*
$ sudo mv ~/Downloads/bosh-cli-* /usr/local/bin/bosh
</pre><p></p></li>
<li><p>Perform one of the following procedures to download and install bosh-bootloader:</p>

<ul>
<li>On Mac OS X, use Homebrew:
<pre class="terminal">$ brew install cloudfoundry/tap/bbl</pre></li>
<li>Download the latest bosh-bootloader from <a href="https://github.com/cloudfoundry/bosh-bootloader/releases/latest">GitHub</a>. Make the binary executable and move it to somewhere in your PATH:
<pre class="terminal">$ chmod +x ~/Downloads/bbl-*
$ sudo mv ~/Downloads/bbl-* /usr/local/bin/bbl
</pre></li>
</ul></li>
<li><p>Download and install the <a href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest">Azure CLI</a>. Azure CLI 2.0 is highly recommended,try to avoid use Azure CLI 1.0.</p></li>
</ol>

<h2 id="-step-2:-create-a-service-principal"><a id="create-service-principal"></a> Step 2: Create a Service Principal</h2>

<p>Perform the following steps to create the service principal that bosh-bootloader needs to interact with Azure:</p>

<ol>
<li><p>If you installed the Azure CLI for the first time, first login:
</p><pre class="terminal">$ az login
</pre><p></p>

<p>You will see following content in terminal:
</p><pre class="terminal">To sign in, use a web browser to open the page <a href="https://microsoft.com/devicelogin">https://microsoft.com/devicelogin</a> and enter the code YOURCODE to authenticate.
</pre><p></p>

<p>Follow the instruction to get you logged in.</p></li>
<li><p>List subscriptions and select a preferred subscription
</p><pre class="terminal">$ az account list
</pre>
You will get a list of your subscription, you should select a preferred subscription:<p></p>

<pre class="terminal">$ az account set --subscription SUBSCRIPTION_ID(or SUBSCRIPTION_NAME)
</pre></li>
<li><p>Create the service principal for bosh-bootloader with the Azure CLI:
</p><pre class="terminal">$ az ad sp create-for-rbac
</pre><p></p>

<p>You will get a json format object:
</p><pre class="terminal">{
    "appId": "YOUR-CLIENT-ID",
    "displayName": "YOUR-SERVICE-PRINCIPAL-DISPLAY-NAME",
    "name": "YOUR-SERVICE-PRINCIPAL-NAME",
    "password": "YOUR-AZURE-CLIENT-SECRET",
    "tenant": "YOUR-TENANT-ID"
}
</pre>
This is credential for BBL to access Azure. Back up it and store it in <strong>safe</strong> location. This credential is only effective in the subscription that you selected in previous step.<p></p>

<p></p><p class="note"><strong>Note</strong>: The service principal created above has default role <strong>Contributor</strong>. You may need more precise access control. Please refer to the <a href="https://docs.microsoft.com/en-us/cli/azure/create-an-azure-service-principal-azure-cli?view=azure-cli-latest">doc</a></p></li>
</ol>

<h2 id="-step-3:-create-infrastructure,-bastion,-bosh-director,-and-application-gateway"><a id="create-infra-bosh"></a> Step 3: Create Infrastructure, Bastion, BOSH Director, and Application Gateway</h2>

<p>Run the following command to create the required infrastructure,
deploy a bastion, deploy a BOSH director and create application gateway
for Cloud Foundry:
</p><pre class="terminal">$ bbl plan \
    --iaas azure \
    --azure-subscription-id YOUR-SUBSCRIPTION-ID \
    --azure-tenant-id YOUR-TENANT-ID \
    --azure-client-id YOUR-CLIENT-ID \
    --azure-client-secret YOUR-CLIENT-SECRET \
    --azure-region YOUR-AZURE-REGION \
    --lb-type cf \
    --lb-cert YOUR-CERT.crt \
    --lb-key YOUR-KEY.key \
    --lb-domain YOUR-SYSTEM-DOMAIN<br>
$ bbl up
</pre><p></p>

<p>Replace the placeholders as follows:</p>

<ul>
<li><code>YOUR-SUBSCRIPTION-ID</code> is the subscription id selected in the previous section.</li>
<li><code>YOUR-TENANT-ID</code> is the “tenant” field of your service principal credential.</li>
<li><code>YOUR-CLIENT-ID</code> is the “appID” field of your service principal credential.</li>
<li><code>YOUR-CLIENT-SECRET</code> is the “password” field of your service principal credential.</li>
<li><code>YOUR-AZURE-REGION</code> is the region that your resource will be created at,such as <code>eastus</code>. All avalible Azure regions can be found <a href="https://azure.microsoft.com/en-us/global-infrastructure/regions/">here</a> </li>
<li><code>YOUR-CERT.crt</code> and <code>YOUR-KEY.key</code> are the 
path to your Certificate Authority (CA) certificate and key. This 
enables SSL/TLS termination at your application gateway.</li>
<li><code>YOUR-SYSTEM-DOMAIN</code> is the DNS domain name for your 
Cloud Foundry instance. Cloud Foundry uses this domain name when 
deploying apps. For example, if you select the name <code>cloud.example.com</code>, Cloud Foundry deploys each of your apps as <code>APP-NAME.cloud.example.com</code>.</li>
</ul>

<p>The <code>bbl up</code> command takes twenty to thirty minutes to complete.</p>

<p>When <code>bbl plan</code> or <code>bbl up</code> is run, files in the <code>--state-dir</code> (or present working
directory) will be created, modified, or deleted.</p>

<p class="note"><strong>Note</strong>: The <b>bbl state directory</b>
contains credentials and other metadata related to your BOSH Director and
infrastructure. Back up this directory and store it in a safe location.</p>

<p>To extract information from the bbl state, use <code>bbl</code>.
For example, to obtain your BOSH Director address, run the following command:</p>

<pre class="terminal">$ bbl director-address
https://YOUR-DIRECTOR-ADDRESS
</pre>

<p>Run <code>bbl</code> to see the full list of values from the state file that you can print.
You must always run <code>bbl</code> from the directory that contains <code>bbl-state.json</code>.</p>

<p>For test and development environments, you can also generate your own
CA certificate and key with a tool such as <a href="https://github.com/square/certstrap">certstrap</a>.</p>

<h2 id="-step-4:-update-dns-records"><a id="update-dns"></a> Step 4: Update DNS Records</h2>

<p>The <code>--lb-*</code> flags create a NS record in Azure’s DNS Zone. You can view
this record by navigating to the resource group created by BBL and selecting DNS Zone in the resource list.</p>

<p>The name servers will have the following format:</p>
<pre class="highlight plaintext"><code>ns1-**.azure-dns.com.
ns2-**.azure-dns.net.
ns3-**.azure-dns.org.
ns4-**.azure-dns.info.
</code></pre>

<p>From your domain registrar, delegate DNS authority for your hosted 
zone to the
four Azure name servers. To do this, change the default nameservers 
provided by your domain registrar to Azure name servers listed in Azure 
DNS Zone.</p>

<p>After a few minutes, your system domain should resolve to your Azure application gateway.</p>

<h2 id="-step-5:-connect-to-the-bosh-director"><a id="connect-bosh-director"></a> Step 5: Connect to the BOSH Director</h2>

<p>Run the following to connect to the BOSH Director:</p>

<pre class="terminal">$ eval "$(bbl print-env)"
</pre>

<h2 id="destroy-the-bosh-resources"><a id="destroy-environment"></a>Destroy the BOSH Resources</h2>

<p>You can use <code>bbl destroy</code> to delete the BOSH Director infrastructure in your AWS environment.
Use this command if <code>bbl up</code> does not complete successfully and you want to reset your environment,
or if you want to destroy the resources created by bosh-bootloader for any other reason.</p>

<p>To delete load balancers only:</p>

<pre class="terminal">$ bbl plan
$ bbl up
</pre>

<p>To delete the infrastructure, bastion, director, and load balancers:</p>

<pre class="terminal">$ bbl destroy
</pre>

        <a id="repo-link" href="http://github.com/cloudfoundry/docs-deploying-cf/tree/master/cf-deployment/azure.html.md.erb">Create a pull request or raise an issue on the source for this page in GitHub</a>

      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    <div class="copyright">
  <a href="http://localhost:4567/">Cloud Foundry Documentation</a>
  © 2018 <a href="https://cloudfoundry.org/">Cloud Foundry Foundation</a>. All Rights Reserved.
</div>
<div class="support">
  <a href="https://www.cloudfoundry.org/community/" target="_blank">Get Involved</a>
</div>

  </footer>
</div><!--end of container-->



</body></html>